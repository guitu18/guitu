package excel;

import cn.afterturn.easypoi.excel.ExcelExportUtil;
import cn.afterturn.easypoi.excel.ExcelImportUtil;
import cn.afterturn.easypoi.excel.entity.ExportParams;
import cn.afterturn.easypoi.excel.entity.ImportParams;
import org.apache.commons.lang3.builder.ReflectionToStringBuilder;
import org.apache.poi.ss.usermodel.Workbook;
import org.junit.Test;

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

/**
 * @author zhangkuan
 * @date 2019/8/21
 */
public class ExcelTest {

    @Test
    public void exportExcel() throws IOException {
        List<Student> list = new ArrayList<>();
        list.add(new Student("张三", 11));
        list.add(new Student("李四", 12));
        list.add(new Student("王五", 13));
        list.add(new Student("赵六", 14));
        File file = new File("D:/excel/");
        if (!file.exists()) {
            file.mkdirs();
        }
        ExportParams exportParams = new ExportParams("计算机一班学生", "学生");
        Workbook workbook = ExcelExportUtil.exportExcel(exportParams, Student.class, list);
        FileOutputStream fos = new FileOutputStream("D:/excel/excel.ExcelTest.export.xls");
        workbook.write(fos);
        fos.close();
    }

    @Test
    public void importExcel() {
        ImportParams params = new ImportParams();
        params.setTitleRows(1);
        params.setHeadRows(1);
        File file = new File("D:/excel/excel.ExcelTest.export.xls");
        List<Student> list = ExcelImportUtil.importExcel(file, Student.class, params);
        System.out.println(ReflectionToStringBuilder.toString(list.get(0)));
    }


}
